module.exports = (client) => {
  client.on("messageCreate", async (message) => {
    if (message.author.bot) return;

    if (message.content.toLowerCase().startsWith("!message")) {
      try {
        // ุงุณู ุงูููุงุฉ ุงููุทููุจุฉ
        const ticketChannelName = "๐ซโopen-ticket";

        // ุงูุจุญุซ ุนู ุงูููุงุฉ ุฏุงุฎู ุงูุณูุฑูุฑ
        const ticketChannel = message.guild.channels.cache.find(
          (ch) => ch.name === ticketChannelName
        );

        // ุงูุชุญูู ูู ูุฌูุฏ ุงูููุงุฉ
        const ticketMention = ticketChannel
          ? `<#${ticketChannel.id}>`
          : `**#${ticketChannelName}**`;

        // ุฅูุดุงุก Embed ุฌุฏูุฏ ูุชุนุฑูู EVO GRAPH
        const evoGraphEmbed = {
          color: 0xf1645f, // ููู ุฎูููุฉ ุฏุงูู
          // title: "๐ **ูุฑุญุจูุง ุจู ูู EVO GRAPH** ๐จ",
          image: {
            url: "https://media.discordapp.net/attachments/1342144217111334912/1342155497024913539/d65ae60f2fcc5d54.png?ex=67b89b36&is=67b749b6&hm=74d1a36bf6ea8c4c3f724a8a8b673b8f94decef612e48f0d2fc0e7b8d917a662&=&format=webp&quality=lossless&width=1056&height=377", // ุงุณุชุจุฏู ูุฐุง ุจุฑุงุจุท ุงูุตูุฑุฉ ุงูุชู ุชุฑูุฏ ุนุฑุถูุง
          },
          // description:
          //   `ุจูุณููู ุงููููููู ุงูุฑููุญูููููฐูู ุงูุฑููุญูููู \`***ููุงููู ุงููุชุฌุฑ***\`\n\n` +
          //   `1- ุงูุฏูุน ูุชู ูุจู ุจุฏุก ุงูุนูู ุนูู ุงูุชุตููู\n\n` +
          //   `2- ูุง ูููู ุงุณุชุฑุฌุงุน ุงู ูุจุงูุบ ูุงููุฉ ุจุนุฏ ุงูุจุฏุก ูู ุงูุชุตููู\n\n` +
          //   `3- ูุญู ููุนููู ุทูุจ ุชุนุฏูููู ( 2 ) ููุท ุนูู ุงูุชุตููู\n\n` +
          //   `4- ุงููุตูู ูู ุงูุญู ุงููุงูู ูู ูุดุฑ ุชุตูููู ุฏุงุฎู ุงููุชุฌุฑ ูุบุฑุถ ุงูุนุฑุถ ููุท\n\n` +
          //   `5- ูููุน ุทูุจ ุชุตููู ูุฌุงูู\n\n` +
          //   `6- ุงูุชูุงุตู ูุน ุงููุตูู ุนู ุงูุทุฑูู ุงูุชูุช ููุท\n\n` +
          //   `7- ุถุฑูุจุฉ ุงูุฏูุน ูุงูุฃุณุชุฑุฌุงุน ูุชุญูููุง ุงูุนููู ุจุงููุงูู\n\n` +
          //   `8- ูุฎูู ุงููุณุคูููุฉ ุนู ุงู ุดุฎุต ูุณุฑู ููุชุฌู ุจุนุฏ ุงูุชุณููู\n\n` +
          //   `9- ููููุน ุทูุจ ุงูุชุณุฑูุน ุจุงูุชุตููู\n\n` +
          //   `10- ุนูุฏ ุงูููุงููุฉ ุนูู ุงูุชุตููู ูู ูุจู ุงูุนููู ูุงูููู ุฅุนุงุฏู ุชุนุฏููู ูุฑู ุฃุฎุฑู\n\n` +
          //   `11- ูุญู ุบูุฑ ูุณุคูููู ูู ุญุงู ุบูุฑุช ูุฑุงุฑู ููุธุฑุชู ุนูู ุงูุฎุฏูุฉ ุจุนุฏ ูุฑูุฑ ูุฏุฉ\n\n` +
          //   `12- ุงูุชุนุงูู ูุจุงุดุฑุฉู ูููู ูู ุงูุนููู ุงูู ( ุงููุฑ ุงูุณูุฑูุฑ ) ููุง ูุณูุญ ุจุงููุณุงุทุฉ\n\n` +
          //   `13- ูููุน ุงูุชุนุฏูู ุนูู ุฅู ูู ุงูุชุตูููุงุช ูู ุตุงูุญ ุณูุฑูุฑ ุฃุฎุฑ ุบูุฑ ุงููุชูู ุนููู\n\n` +
          //   `14- ูููุงุช ุงูุชุตููู ูุชู ุชุณููููุง ูุตุงุญุจ ุงูุจุฑูุดู ููุท\n\n` +
          //   `15- ูุชู ุชุณููู ุงูุทูุจ ูุฑุฉ ูุงุญุฏุฉ ููุท ู ุงู ุชุนุฏูู ููุดูู ูุงูู ุจุนุฏ ุงูุชุณููู ูุชู ุฏูุน ุณุนุฑ ุงูุทูุจ\n\n` +
          //   `16- ูู ุญุงู ุชู ุงูุฅุชูุงู ุนูู ุฑุณู ุดุนุงุฑ ูุนูู ูุจุนุฏ ุงูุฑุณู ุชุฎูู ุนูู ุงูุนููู ูุชู ุฎุตู ูุตู ุณุนุฑ ุงูุดุนุงุฑ\n\n` +
          //   `17- ููููุน ุทูุจ ุงูุชุตููู ููุชูุญ (PSD , AI , AEP)\n\n` +
          //   `18- ูู ุญุงู ุชู ุงูุทูุจ ููุชุฌ ู ุงูุฎุฑูุฌ ูู ุงูุฏุณููุฑุฏ ุณูู ูุชู ุงุบูุงู ุงูุชูุช ู ุนุฏู ุงุฑุฌุงุน ุงููุจูุบ ูู ุญุงู ุชู ุงูุจุฏุก ูู ุงูููุชุฌ\n\n` +
          //   `19- ููููุน ููุงุฆูุงู ุทูุจ ููู ุงูุฑุชุจ ูู ุฃู ุญุงู ูู ุงูุฃุญูุงู\n\n` +
          //   `20- ุจุนุฏ ูุชุญ ุงูุชููุช ุงูุชุจ ูู ุทูุจุงุชู ุญุชู ูุชู ุงูุฑุฏ ุนูููู ูู ูุจู ุงููุตูู\n\n` +
          //   `21- ูุฌุจ ุดุฑุญ ูุงูู ูุทูุจู ูุน ุฐูุฑ ุงูุงููุงู ุงููุชู ุชุฑูุฏูุง\n\n` +
          //   `22- ุฌููุน ุงูููุงููู ูุงุจูุฉ ููุชุนุฏูู\n\n` +
          //   `**ุดูุฑุงู ุนูู ุญุณู ุชุนุงูููู ูุนูุง ูุชููู ููู ุฏุงุฆูุงู ุงูุฃูุถู**`,
          // footer: {
          //   text: "EVO GRAPH - ุงูุฅุจุฏุงุน ูุจุฏุฃ ููุง!",
          //   icon_url:
          //     "https://res.cloudinary.com/dxfyhkj2l/image/upload/fl_preserve_transparency/v1739545365/Screenshot_2025-02-12_143112_lahkok.jpg", // ุฑุงุจุท ุดุนุงุฑ ุงููุชุฌุฑ
          // },
        };

        // ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุงูุฌุฏูุฏุฉ
        const sentMessage = await message.channel.send({
          embeds: [evoGraphEmbed],
        });

        // ุชุซุจูุช ุงูุฑุณุงูุฉ
        await sentMessage.pin();

        // ุญุฐู ุฑุณุงูุฉ ูุธุงู ุงูุชุซุจูุช
        const fetchedMessages = await message.channel.messages.fetch({
          limit: 1,
        });
        const systemPinMessage = fetchedMessages.first();
        if (systemPinMessage?.system) {
          await systemPinMessage.delete();
        }

        // ุญุฐู ุฑุณุงูุฉ ุงูุฃูุฑ ุงูุฃุตููุฉ
        await message.delete();
      } catch (error) {
        console.error("โ Error:", error);
        if (error.message.includes("Missing Permissions")) {
          await message.reply("โ ุงูุจูุช ูุง ูููู ุตูุงุญูุงุช ูุงููุฉ");
        } else {
          await message.reply("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุฃู ุชุซุจูุช ุงูุฑุณุงูุฉ");
        }
      }
    }
  });
};
